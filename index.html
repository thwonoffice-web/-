<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>í˜‘ë ¥ì‚¬ì—…ë³¸ë¶€ ê´€ë¦¬ ì‹œìŠ¤í…œ</title>
<style>
/* [ê¸°ë³¸ ìŠ¤íƒ€ì¼] */
body{font-family:'Noto Sans KR',sans-serif;background:#f4f6fb;margin:0;color:#333; padding-bottom: 120px;}
header{background:#fff;border-bottom:1px solid #e5e8f0;padding:16px 24px; position: sticky; top: 0; z-index: 1000; display: flex; justify-content: space-between; align-items: center;}
.logo { font-size: 20px; font-weight: 700; color: #4f6fdc; cursor: pointer; transition: 0.2s; }

/* ê´€ë¦¬ì ëª¨ë“œ ë°°ì§€ */
.admin-badge { font-size: 12px; padding: 4px 10px; border-radius: 6px; margin-left: 15px; font-weight: 600; display: none; vertical-align: middle; }
.mode-admin { background: #4f6fdc; color: #fff; box-shadow: 0 2px 8px rgba(79, 111, 220, 0.3); display: inline-block; }

/* [ì¤‘ì•™ í•˜ë‹¨ ë¡œê³  ì´ë¯¸ì§€ ë²„íŠ¼ - ì„ ëª…í•˜ê²Œ ìœ ì§€] */
.admin-login-img {
  position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%);
  cursor: pointer; z-index: 1500; transition: all 0.3s ease;
  width: 200px; 
  opacity: 1; /* í¬ë¯¸í•˜ì§€ ì•Šê²Œ 1ë¡œ ì„¤ì • */
}
.admin-login-img:hover { transform: translateX(-50%) scale(1.08); filter: drop-shadow(0 5px 15px rgba(0,0,0,0.1)); }

/* ì•”í˜¸ ì…ë ¥ ëª¨ë‹¬ì°½ */
#loginModal {
  display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
  background: rgba(0,0,0,0.5); z-index: 2000; justify-content: center; align-items: center;
}
.modal-content { background: #fff; padding: 30px; border-radius: 20px; text-align: center; width: 300px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
.modal-content h3 { margin-top: 0; margin-bottom: 20px; }
.modal-content input { width: 80%; padding: 12px; margin-bottom: 20px; border: 1px solid #ddd; border-radius: 10px; text-align: center; font-size: 18px; letter-spacing: 5px;}

.admin-tab { display: none; } 

main{max-width:1200px;margin:30px auto}
.dashboard { display: flex; gap: 30px; justify-content: center; padding: 60px 20px; }
.dash-btn { flex: 1; max-width: 280px; aspect-ratio: 1/1; display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 20px; cursor: pointer; border: 1px solid #e5e8f0; border-radius: 32px; background: #fff; color: #4f6fdc; font-size: 22px; font-weight: 700; box-shadow: 0 10px 30px rgba(79,111,220,0.08); transition: 0.3s; }
.dash-btn span { font-size: 60px; }
.dash-btn:hover { transform: translateY(-12px); background: linear-gradient(135deg, #4f6fdc, #3b5bdb); color: #fff; }

.card{background:#fff;padding:24px;border-radius:16px;box-shadow:0 8px 20px rgba(0,0,0,.05);margin-bottom:20px}
button{cursor:pointer;border:none;border-radius:12px;padding:8px 14px;background:#e9edfb;color:#4f6fdc; font-weight: 600;}

table{width:100%;border-collapse:collapse;margin-top:12px}
th,td{padding:12px 8px;text-align:center;border-bottom:1px solid #e6e9f2; font-size: 14px}
th{background:#f6f8ff; color: #555;}
.bg-kuk { background-color: #f0f4ff !important; color: #3b5bdb; }
.bg-si { background-color: #fff9f0 !important; color: #d26900; }
.total-cell { background-color: #f8faff; font-weight: 800; color: #4f6fdc; }

.nav { display: flex; gap: 8px; margin: 20px 0; }
.nav button{border-radius:999px;padding:10px 20px; background: #fff; border: 1px solid #dcdfea; color: #666;}
.nav button.active{background:#4f6fdc;color:#fff; border-color: #4f6fdc;}

.month-tabs{display:flex;gap:6px;flex-wrap:wrap; margin-bottom: 15px;}
.month-tabs button{border-radius:999px; font-size: 13px;}
.month-tabs button.active{background:#4f6fdc;color:#fff}

.summary{display:flex;gap:20px;margin-bottom:20px}
.summary div{flex:1;padding:18px;border-radius:14px;text-align:center;font-weight:700}
.summary .pay{background:#eef2ff;color:#4f6fdc}
.summary .agency{background:#fff1e6;color:#d26900}

input[type=number], input[type=text]{padding: 5px; border-radius: 5px; border: 1px solid #ddd;}
</style>
</head>
<body>

<div id="loginModal">
  <div class="modal-content">
    <h3>ê´€ë¦¬ì ì¸ì¦</h3>
    <input type="password" id="pwInput" placeholder="ì•”í˜¸ ì…ë ¥" onkeyup="if(window.event.keyCode==13){checkPassword()}">
    <div style="display: flex; gap: 10px; justify-content: center;">
      <button onclick="checkPassword()" style="background:#4f6fdc; color:#fff;">í™•ì¸</button>
      <button onclick="closeLogin()" style="background:#eee; color:#333;">ì·¨ì†Œ</button>
    </div>
  </div>
</div>

<header>
  <div>
    <span class="logo" onclick="goMain()">ê´‘ì£¼ìƒê³µíšŒì˜ì†Œ í˜‘ë ¥ì‚¬ì—…ë³¸ë¶€</span>
    <span id="adminStatus" class="admin-badge">ê´€ë¦¬ì ëª¨ë“œ</span>
  </div>
</header>

<main>
  <section id="screenMain">
    <div class="dashboard">
      <button class="dash-btn" onclick="openLabor()"><span>ğŸ‘¤</span>ì¸ê±´ë¹„ ê´€ë¦¬</button>
      <button class="dash-btn" onclick="openBiz()"><span>ğŸ’¼</span>ì‚¬ì—… ê´€ë¦¬</button>
    </div>
  </section>

  <section id="screenBiz" style="display:none">
    <div class="card">
      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
        <h2>ğŸ’¼ ì‚¬ì—… ê´€ë¦¬</h2>
        <button onclick="goMain()" style="background:#666; color:#fff;">ë’¤ë¡œê°€ê¸°</button>
      </div>
      <div style="text-align:center; padding:50px; border:2px dashed #ddd; border-radius:20px; color:#999;">
        <span style="font-size:40px;">ğŸ—ï¸</span>
        <p>ì‚¬ì—… ê´€ë¦¬ ê¸°ëŠ¥ì€ í˜„ì¬ êµ¬ì¶• ì¤‘ì…ë‹ˆë‹¤.</p>
      </div>
    </div>
  </section>

  <section id="screenLabor" style="display:none">
    <div class="nav">
      <button class="tab active" data-tab="personal">ê°œì¸ë³„ í˜„í™©</button>
      <button class="tab" data-tab="month">ì›”ë³„ í˜„í™©</button>
      <button class="tab admin-tab" data-tab="payroll">ê¸‰ì—¬ê´€ë¦¬</button>
      <button class="tab admin-tab" data-tab="agency">ê¸°ê´€ë¶€ë‹´ê¸ˆ</button>
      <button onclick="goMain()" style="margin-left:auto; background:#666; color:#fff; border-radius:999px;">ë©”ì¸ìœ¼ë¡œ</button>
    </div>
    
    <section id="personal">
      <div class="card"><h2>ğŸ‘¤ ê°œì¸ë³„ ëˆ„ì  í˜„í™©</h2><table><thead><tr><th rowspan="2">ì´ë¦„</th><th colspan="2" class="bg-kuk">êµ­ë¹„ ëˆ„ì </th><th colspan="2" class="bg-si">ì‹œë¹„ ëˆ„ì </th><th rowspan="2">ì´ ì§€ì¶œ í•©ê³„</th></tr><tr><th class="bg-kuk">ê¸‰ì—¬</th><th class="bg-kuk">ê¸°ê´€ë¶€ë‹´</th><th class="bg-si">ê¸‰ì—¬</th><th class="bg-si">ê¸°ê´€ë¶€ë‹´</th></tr></thead><tbody id="personalBody"></tbody></table></div>
    </section>

    <section id="month" style="display:none">
      <div class="card"><h2>ğŸ“… ì›”ë³„ ìƒì„¸ í˜„í™©</h2><div class="summary"><div class="pay" id="sumPayroll"></div><div class="agency" id="sumAgency"></div></div><div id="statusMonthTabs" class="month-tabs"></div><div id="monthDetail" style="display:none; margin-top:20px; padding:20px; border:1px dashed #4f6fdc; border-radius:16px;"><h3 id="selectedMonthTitle" style="color:#4f6fdc"></h3><div id="monthDataArea"></div></div></div>
    </section>

    <section id="payroll" style="display:none">
      <div class="card"><div style="display:flex; justify-content:space-between; align-items:center;"><h2>ğŸ’° ê¸‰ì—¬ê´€ë¦¬</h2><button onclick="addPayroll()" style="background:#4f6fdc; color:#fff;">ì§ì› ì¶”ê°€</button></div><div id="payrollTabs" class="month-tabs"></div><table><thead><tr><th>êµ¬ë¶„</th><th>ì´ë¦„</th><th>ê¸°ë³¸ê¸‰</th><th>ê³µì œ</th><th>ì‹¤ì§€ê¸‰</th><th>ì‚­ì œ</th></tr></thead><tbody id="payrollBody"></tbody><tfoot id="payrollFoot"></tfoot></table></div>
    </section>

    <section id="agency" style="display:none">
      <div class="card"><div style="display:flex; justify-content:space-between; align-items:center;"><h2>ğŸ¥ ê¸°ê´€ë¶€ë‹´ê¸ˆ</h2><button onclick="addAgency()" style="background:#4f6fdc; color:#fff;">ì§ì› ì¶”ê°€</button></div><div id="agencyTabs" class="month-tabs"></div><table><thead><tr><th>êµ¬ë¶„</th><th>ì´ë¦„</th><th>êµ­ë¯¼</th><th>ê±´ê°•</th><th>ê³ ìš©</th><th>ì‚°ì¬</th><th>í•©ê³„</th><th>ì‚­ì œ</th></tr></thead><tbody id="agencyBody"></tbody><tfoot id="agencyFoot"></tfoot></table></div>
    </section>
  </section>
</main>

<img src="ê´‘ì£¼ìƒì˜.png" class="admin-login-img" id="adminBtn" onclick="handleAdminClick()" title="ê´€ë¦¬ì ì¸ì¦ ë¡œê·¸ì¸">

<script>
let isAdmin = false;
const ADMIN_PW = "1234"; 

// í™”ë©´ ì „í™˜ í•¨ìˆ˜ ê°œì„ 
const screenMain=document.getElementById("screenMain"), 
      screenLabor=document.getElementById("screenLabor"), 
      screenBiz=document.getElementById("screenBiz");

function goMain(){ 
  screenMain.style.display="block"; 
  screenLabor.style.display="none"; 
  screenBiz.style.display="none"; 
}
function openLabor(){ 
  screenMain.style.display="none"; 
  screenLabor.style.display="block"; 
  screenBiz.style.display="none";
  renderPersonal(); 
  updateSummary(); 
}
function openBiz(){ 
  screenMain.style.display="none"; 
  screenLabor.style.display="none"; 
  screenBiz.style.display="block"; 
}

function handleAdminClick() {
  if (isAdmin) {
    if(confirm("ê´€ë¦¬ì ëª¨ë“œë¥¼ ì¢…ë£Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
      isAdmin = false;
      applyAdminMode();
    }
  } else {
    document.getElementById('loginModal').style.display = 'flex';
    document.getElementById('pwInput').focus();
  }
}

function closeLogin() {
  document.getElementById('loginModal').style.display = 'none';
  document.getElementById('pwInput').value = '';
}

function checkPassword() {
  const pw = document.getElementById('pwInput').value;
  if (pw === ADMIN_PW) {
    isAdmin = true;
    closeLogin();
    applyAdminMode();
  } else {
    alert("ì•”í˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤.");
    document.getElementById('pwInput').value = '';
  }
}

function applyAdminMode() {
  const adminTabs = document.querySelectorAll('.admin-tab');
  const status = document.getElementById('adminStatus');
  adminTabs.forEach(el => el.style.display = isAdmin ? 'block' : 'none');
  status.style.display = isAdmin ? 'inline-block' : 'none';
  if(!isAdmin && (screenLabor.style.display === "block")) {
      // ê´€ë¦¬ì íƒ­ì„ ë³´ê³  ìˆë‹¤ê°€ ë¡œê·¸ì•„ì›ƒí•˜ë©´ ê°œì¸ë³„ í˜„í™©ìœ¼ë¡œ ê°•ì œ ì´ë™
      document.querySelector('[data-tab="personal"]').click();
  }
}

/* ë°ì´í„° ì²˜ë¦¬ ë¡œì§ (ê¸°ì¡´ê³¼ ë™ì¼) */
document.querySelectorAll(".tab").forEach(b=>{
  b.onclick=()=>{
    document.querySelectorAll(".tab").forEach(x=>x.classList.remove("active"));
    b.classList.add("active");
    ["personal","month","payroll","agency"].forEach(id=>document.getElementById(id).style.display="none");
    document.getElementById(b.dataset.tab).style.display="block";
    if(b.dataset.tab === "personal") renderPersonal();
    if(b.dataset.tab === "month") renderMonthStatusTabs();
  }
});

let curP=1, curA=1;
const P=m=>JSON.parse(localStorage.getItem("payroll_"+m))||[];
const A=m=>JSON.parse(localStorage.getItem("agency_"+m))||[];

function monthTabs(id,cb){
  const el=document.getElementById(id); el.innerHTML="";
  for(let i=1;i<=12;i++){
    const b=document.createElement("button"); b.textContent=i+"ì›”";
    b.onclick=()=>{cb(i);[...el.children].forEach(x=>x.classList.remove("active"));b.classList.add("active")};
    el.appendChild(b);
  }
  if(el.children.length > 0) el.children[0].click();
}

function addPayroll(d={}){
  const tr=document.createElement("tr");
  tr.innerHTML=`<td><select onchange="savePayroll()"><option ${d.type==='êµ­ë¹„'?'selected':''}>êµ­ë¹„</option><option ${d.type==='ì‹œë¹„'?'selected':''}>ì‹œë¹„</option></select></td><td><input type="text" value="${d.name||""}" oninput="savePayroll()"></td><td><input type="number" value="${d.base||0}" oninput="savePayroll()"></td><td><input type="number" value="${d.ded||0}" oninput="savePayroll()"></td><td class="net"></td><td><button onclick="this.closest('tr').remove();savePayroll()" style="background:#ffe3e3; color:#e03131;">ì‚­ì œ</button></td>`;
  payrollBody.appendChild(tr);
  savePayroll();
}
function savePayroll(){
  let arr=[],sum=0;
  payrollBody.querySelectorAll("tr").forEach(tr=>{
    const i=tr.querySelectorAll("input"); const net=(+i[1].value||0)-(+i[2].value||0);
    tr.querySelector(".net").textContent=net.toLocaleString(); sum+=net;
    arr.push({type:tr.querySelector("select").value,name:i[0].value,base:+i[1].value||0,ded:+i[2].value||0});
  });
  localStorage.setItem("payroll_"+curP,JSON.stringify(arr));
  payrollFoot.innerHTML=`<tr><td colspan="4" style="text-align:right; font-weight:700;">ì›” í•©ê³„:</td><td style="font-weight:700; color:#4f6fdc;">${sum.toLocaleString()}</td><td></td></tr>`;
  updateSummary();
}
function loadPayroll(){ payrollBody.innerHTML=""; P(curP).forEach(addPayroll); savePayroll(); }

function addAgency(d={}){
  const tr=document.createElement("tr");
  tr.innerHTML=`<td><select onchange="saveAgency()"><option ${d.type==='êµ­ë¹„'?'selected':''}>êµ­ë¹„</option><option ${d.type==='ì‹œë¹„'?'selected':''}>ì‹œë¹„</option></select></td><td><input type="text" value="${d.name||""}" oninput="saveAgency()"></td><td><input type="number" value="${d.n||0}" oninput="saveAgency()"></td><td><input type="number" value="${d.h||0}" oninput="saveAgency()"></td><td><input type="number" value="${d.e||0}" oninput="saveAgency()"></td><td><input type="number" value="${d.i||0}" oninput="saveAgency()"></td><td class="sum"></td><td><button onclick="this.closest('tr').remove();saveAgency()" style="background:#ffe3e3; color:#e03131;">ì‚­ì œ</button></td>`;
  agencyBody.appendChild(tr);
  saveAgency();
}
function saveAgency(){
  let arr=[],sum=0;
  agencyBody.querySelectorAll("tr").forEach(tr=>{
    const i=tr.querySelectorAll("input"); const s=(+i[1].value)+(+i[2].value)+(+i[3].value)+(+i[4].value);
    tr.querySelector(".sum").textContent=s.toLocaleString(); sum+=s;
    arr.push({type:tr.querySelector("select").value,name:i[0].value,n:+i[1].value,h:+i[2].value,e:+i[3].value,i:+i[4].value});
  });
  localStorage.setItem("agency_"+curA,JSON.stringify(arr));
  agencyFoot.innerHTML=`<tr><td colspan="6" style="text-align:right; font-weight:700;">ì›” í•©ê³„:</td><td style="font-weight:700; color:#d26900;">${sum.toLocaleString()}</td><td></td></tr>`;
  updateSummary();
}
function loadAgency(){ agencyBody.innerHTML=""; A(curA).forEach(addAgency); saveAgency(); }

function updateSummary(){
  let sp=0, sa=0;
  for(let m=1;m<=12;m++){
    sp += P(m).reduce((x,r)=>x+(r.base-r.ded),0);
    sa += A(m).reduce((x,r)=>x+r.n+r.h+r.e+r.i,0);
  }
  document.getElementById("sumPayroll").textContent = `ì—°ê°„ ê¸‰ì—¬ í•©ê³„: ${sp.toLocaleString()}ì›`;
  document.getElementById("sumAgency").textContent = `ì—°ê°„ ê¸°ê´€ë¶€ë‹´ê¸ˆ í•©ê³„: ${sa.toLocaleString()}ì›`;
}

function renderMonthStatusTabs(){
  const container = document.getElementById("statusMonthTabs"); container.innerHTML = "";
  for(let i=1; i<=12; i++){
    const b = document.createElement("button"); b.textContent = i + "ì›”";
    b.onclick = () => { [...container.children].forEach(x=>x.classList.remove("active")); b.classList.add("active"); showMonthDetail(i); };
    container.appendChild(b);
  }
  if(container.children.length > 0) container.children[0].click();
}

function showMonthDetail(m){
  const area = document.getElementById("monthDataArea"), title = document.getElementById("selectedMonthTitle");
  document.getElementById("monthDetail").style.display = "block"; title.textContent = m + "ì›” ì§€ì¶œ ë‚´ì—­";
  const p = P(m), a = A(m); const ps = p.reduce((x,r)=>x+(r.base-r.ded),0), as = a.reduce((x,r)=>x+r.n+r.h+r.e+r.i,0);
  area.innerHTML = `<div style="margin-bottom:15px; font-weight:bold;">ì›” ì´ì•¡: ${(ps+as).toLocaleString()}ì›</div>
    <strong>ê¸‰ì—¬ ë‚´ì—­</strong><table><tr><th>êµ¬ë¶„</th><th>ì´ë¦„</th><th>ì‹¤ì§€ê¸‰ì•¡</th></tr>${p.map(r=>`<tr><td>${r.type}</td><td>${r.name}</td><td>${(r.base-r.ded).toLocaleString()}ì›</td></tr>`).join("") || "<tr><td colspan=3>ë‚´ì—­ ì—†ìŒ</td></tr>"}</table><br>
    <strong>ê¸°ê´€ë¶€ë‹´ê¸ˆ ë‚´ì—­</strong><table><tr><th>êµ¬ë¶„</th><th>ì´ë¦„</th><th>í•©ê³„</th></tr>${a.map(r=>`<tr><td>${r.type}</td><td>${r.name}</td><td>${(r.n+r.h+r.e+r.i).toLocaleString()}ì›</td></tr>`).join("") || "<tr><td colspan=3>ë‚´ì—­ ì—†ìŒ</td></tr>"}</table>`;
}

function renderPersonal(){
  const body = document.getElementById("personalBody"); body.innerHTML = "";
  let userMap = {};
  for(let m=1;m<=12;m++){
    P(m).forEach(r=>{ if(r.name){ if(!userMap[r.name]) userMap[r.name]={kp:0, ka:0, sp:0, sa:0}; if(r.type==='êµ­ë¹„') userMap[r.name].kp+=(r.base-r.ded); else userMap[r.name].sp+=(r.base-r.ded); } });
    A(m).forEach(r=>{ if(r.name){ if(!userMap[r.name]) userMap[r.name]={kp:0, ka:0, sp:0, sa:0}; const s=(r.n+r.h+r.e+r.i); if(r.type==='êµ­ë¹„') userMap[r.name].ka+=s; else userMap[r.name].sa+=s; } });
  }
  Object.keys(userMap).sort().forEach(n=>{
    const d=userMap[n]; const total=d.kp+d.ka+d.sp+d.sa;
    const tr = document.createElement("tr");
    tr.innerHTML = `<td style="font-weight:bold">${n}</td><td class="bg-kuk">${d.kp.toLocaleString()}ì›</td><td class="bg-kuk">${d.ka.toLocaleString()}ì›</td><td class="bg-si">${d.sp.toLocaleString()}ì›</td><td class="bg-si">${d.sa.toLocaleString()}ì›</td><td class="total-cell">${total.toLocaleString()}ì›</td>`;
    body.appendChild(tr);
  });
}

// ì´ˆê¸°í™”
monthTabs("payrollTabs",m=>{curP=m;loadPayroll();});
monthTabs("agencyTabs",m=>{curA=m;loadAgency();});
</script>
</body>
</html>