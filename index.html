<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>í˜‘ë ¥ì‚¬ì—…ë³¸ë¶€ ê´€ë¦¬ ì‹œìŠ¤í…œ</title>
<style>
/* [ê¸°ë³¸ ìŠ¤íƒ€ì¼] */
body{font-family:'Noto Sans KR',sans-serif;background:#f4f6fb;margin:0;color:#333}
header{background:#fff;border-bottom:1px solid #e5e8f0;padding:16px 24px; position: sticky; top: 0; z-index: 1000;}

/* ë¡œê³  í™ˆ ë²„íŠ¼ */
.logo {
  display: inline-block;
  font-size: 20px;
  font-weight: 700;
  color: #4f6fdc;
  cursor: pointer;
  transition: opacity 0.2s;
  user-select: none;
}
.logo:hover { opacity: 0.7; }
.logo:active { transform: scale(0.98); }

main{max-width:1200px;margin:30px auto}

/* [ëŒ€ì‹œë³´ë“œ ë²„íŠ¼ ë””ìì¸] */
.dashboard { display: flex; gap: 30px; justify-content: center; padding: 60px 20px; }
.dash-btn {
  flex: 1; max-width: 280px; aspect-ratio: 1 / 1; 
  display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 20px;
  cursor: pointer; border: 1px solid #e5e8f0; border-radius: 32px; background: #ffffff; color: #4f6fdc;
  font-size: 22px; font-weight: 700; box-shadow: 0 10px 30px rgba(79, 111, 220, 0.08);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}
.dash-btn span { font-size: 60px; } /* ì•„ì´ì½˜ í¬ê¸° ì‚´ì§ í‚¤ì›€ */
.dash-btn:hover {
  transform: translateY(-12px); background: linear-gradient(135deg, #4f6fdc, #3b5bdb); color: #fff;
  box-shadow: 0 20px 40px rgba(79, 111, 220, 0.25);
}
.dash-btn:active { transform: scale(0.95); }

/* [ì¹´ë“œ ë° ê³µìš© ìŠ¤íƒ€ì¼] */
.card{background:#fff;padding:24px;border-radius:16px;box-shadow:0 8px 20px rgba(0,0,0,.05);margin-bottom:20px}
button{cursor:pointer;border:none;border-radius:12px;padding:8px 14px;background:#e9edfb;color:#4f6fdc;transition:.2s}
button:hover{background:#dfe5ff}

table{width:100%;border-collapse:collapse;margin-top:12px}
th,td{padding:12px 8px;text-align:center;border-bottom:1px solid #e6e9f2; font-size: 14px}
th{background:#f6f8ff;font-weight:600}

.bg-kuk { background-color: #f0f4ff !important; color: #3b5bdb; }
.bg-si { background-color: #fff9f0 !important; color: #d26900; }
.total-cell { background-color: #f8faff; font-weight: 800; color: #4f6fdc; }

input,select{padding:6px 8px;border-radius:8px;border:1px solid #dcdfea}
input[type=number]{width:90px;text-align:right}

.nav { display: flex; gap: 8px; margin: 20px 0; }
.nav button{border-radius:999px;padding:10px 20px; background: #fff; border: 1px solid #dcdfea; color: #666;}
.nav button.active{background:#4f6fdc;color:#fff; border-color: #4f6fdc;}

.month-tabs{display:flex;gap:6px;flex-wrap:wrap; margin-bottom: 15px;}
.month-tabs button{border-radius:999px; font-size: 13px;}
.month-tabs button.active{background:#4f6fdc;color:#fff}

.summary{display:flex;gap:20px;margin-bottom:20px}
.summary div{flex:1;padding:18px;border-radius:14px;text-align:center;font-weight:700}
.summary .pay{background:#eef2ff;color:#4f6fdc}
.summary .agency{background:#fff1e6;color:#d26900}

.top-bar{display:flex;align-items:center;margin-bottom:15px}
.top-bar h2 { margin: 0; }
.top-bar button{margin-left:auto;background:#4f6fdc;color:#fff}

.detail-box { margin-top: 20px; padding: 20px; border: 1px dashed #4f6fdc; border-radius: 16px; background: #fff; }
</style>
</head>
<body>

<header>
  <div class="logo" onclick="goMain()">ê´‘ì£¼ìƒê³µíšŒì˜ì†Œ í˜‘ë ¥ì‚¬ì—…ë³¸ë¶€</div>
</header>

<main>
  <section id="screenMain">
    <div class="dashboard">
      <button class="dash-btn" onclick="openLabor()">
        <span>ğŸ‘¤</span> ì¸ê±´ë¹„ ê´€ë¦¬
      </button>
      <button class="dash-btn" onclick="openBiz()">
        <span>ğŸ’¼</span> ì‚¬ì—… ê´€ë¦¬
      </button>
    </div>
  </section>

  <section id="screenBiz" style="display:none">
    <div class="card">
      <h2>ğŸ’¼ ì‚¬ì—… ê´€ë¦¬</h2>
      <p style="color:#666; margin-top:10px;">ë³¸ë¶€ ë‚´ ì¶”ì§„ ì¤‘ì¸ ì‚¬ì—…ì˜ ì˜ˆì‚° ì§‘í–‰ ë‚´ì—­ì„ ê´€ë¦¬í•˜ëŠ” ê³µê°„ì…ë‹ˆë‹¤.</p>
      <div style="padding:40px; text-align:center; background:#f9f9f9; border-radius:12px; border:1px dashed #ccc; margin-top:20px;">
        ì„¤ê³„ ì¤‘ì¸ ê¸°ëŠ¥ì…ë‹ˆë‹¤.
      </div>
    </div>
  </section>

  <section id="screenLabor" style="display:none">
    <div class="nav">
      <button class="tab active" data-tab="personal">ê°œì¸ë³„ í˜„í™©</button>
      <button class="tab" data-tab="month">ì›”ë³„ í˜„í™©</button>
      <button class="tab" data-tab="payroll">ê¸‰ì—¬ê´€ë¦¬</button>
      <button class="tab" data-tab="agency">ê¸°ê´€ë¶€ë‹´ê¸ˆ</button>
    </div>
    
    <section id="personal">
      <div class="card">
        <h2>ğŸ‘¤ ê°œì¸ë³„ ëˆ„ì  í˜„í™©</h2>
        <table>
          <thead>
            <tr>
              <th rowspan="2">ì´ë¦„</th>
              <th colspan="2" class="bg-kuk">êµ­ë¹„ ëˆ„ì </th>
              <th colspan="2" class="bg-si">ì‹œë¹„ ëˆ„ì </th>
              <th rowspan="2">ì´ ì§€ì¶œ í•©ê³„</th>
            </tr>
            <tr>
              <th class="bg-kuk">ê¸‰ì—¬</th><th class="bg-kuk">ê¸°ê´€ë¶€ë‹´</th>
              <th class="bg-si">ê¸‰ì—¬</th><th class="bg-si">ê¸°ê´€ë¶€ë‹´</th>
            </tr>
          </thead>
          <tbody id="personalBody"></tbody>
        </table>
      </div>
    </section>

    <section id="month" style="display:none">
      <div class="card">
        <h2>ğŸ“… ì›”ë³„ ìƒì„¸ í˜„í™©</h2>
        <div class="summary">
          <div class="pay" id="sumPayroll"></div>
          <div class="agency" id="sumAgency"></div>
        </div>
        <div id="statusMonthTabs" class="month-tabs"></div>
        <div id="monthDetail" class="detail-box" style="display:none">
          <h3 id="selectedMonthTitle" style="color:#4f6fdc"></h3>
          <div id="monthDataArea"></div>
        </div>
      </div>
    </section>

    <section id="payroll" style="display:none">
      <div class="card">
        <div class="top-bar"><h2>ğŸ’° ê¸‰ì—¬ê´€ë¦¬</h2><button onclick="addPayroll()">ì§ì› ì¶”ê°€</button></div>
        <div id="payrollTabs" class="month-tabs"></div>
        <table>
          <thead><tr><th>êµ¬ë¶„</th><th>ì´ë¦„</th><th>ê¸°ë³¸ê¸‰</th><th>ê³µì œ</th><th>ì‹¤ì§€ê¸‰</th><th>ì‚­ì œ</th></tr></thead>
          <tbody id="payrollBody"></tbody>
          <tfoot id="payrollFoot"></tfoot>
        </table>
      </div>
    </section>

    <section id="agency" style="display:none">
      <div class="card">
        <div class="top-bar"><h2>ğŸ¥ ê¸°ê´€ë¶€ë‹´ê¸ˆ</h2><button onclick="addAgency()">ì§ì› ì¶”ê°€</button></div>
        <div id="agencyTabs" class="month-tabs"></div>
        <table>
          <thead><tr><th>êµ¬ë¶„</th><th>ì´ë¦„</th><th>êµ­ë¯¼</th><th>ê±´ê°•</th><th>ê³ ìš©</th><th>ì‚°ì¬</th><th>í•©ê³„</th><th>ì‚­ì œ</th></tr></thead>
          <tbody id="agencyBody"></tbody>
          <tfoot id="agencyFoot"></tfoot>
        </table>
      </div>
    </section>
  </section>
</main>

<script>
/* [í™”ë©´ ì „í™˜ ë¡œì§] */
const screenMain=document.getElementById("screenMain"), screenLabor=document.getElementById("screenLabor"), screenBiz=document.getElementById("screenBiz");
function goMain(){ screenMain.style.display="block"; screenLabor.style.display="none"; screenBiz.style.display="none"; }
function openLabor(){ screenMain.style.display="none"; screenLabor.style.display="block"; renderPersonal(); updateSummary(); }
function openBiz(){ screenMain.style.display="none"; screenLabor.style.display="none"; screenBiz.style.display="block"; }

/* [íƒ­ ì „í™˜ ë¡œì§] */
document.querySelectorAll(".tab").forEach(b=>{
  b.onclick=()=>{
    document.querySelectorAll(".tab").forEach(x=>x.classList.remove("active"));
    b.classList.add("active");
    ["personal","month","payroll","agency"].forEach(id=>document.getElementById(id).style.display="none");
    document.getElementById(b.dataset.tab).style.display="block";
    if(b.dataset.tab === "personal") renderPersonal();
    if(b.dataset.tab === "month") renderMonthStatusTabs();
  }
});

/* [ë°ì´í„° ê´€ë¦¬ ê³µí†µ] */
let curP=1, curA=1;
const P=m=>JSON.parse(localStorage.getItem("payroll_"+m))||[];
const A=m=>JSON.parse(localStorage.getItem("agency_"+m))||[];

function monthTabs(id,cb){
  const el=document.getElementById(id); el.innerHTML="";
  for(let i=1;i<=12;i++){
    const b=document.createElement("button"); b.textContent=i+"ì›”";
    b.onclick=()=>{cb(i);[...el.children].forEach(x=>x.classList.remove("active"));b.classList.add("active")};
    el.appendChild(b);
  }
  el.children[0].click();
}

/* [ì¸ê±´ë¹„/ê¸°ê´€ë¶€ë‹´ê¸ˆ CRUD] */
function addPayroll(d={}){
  const tr=document.createElement("tr");
  tr.innerHTML=`<td><select onchange="savePayroll()"><option ${d.type==='êµ­ë¹„'?'selected':''}>êµ­ë¹„</option><option ${d.type==='ì‹œë¹„'?'selected':''}>ì‹œë¹„</option></select></td>
    <td><input value="${d.name||""}" oninput="savePayroll()"></td>
    <td><input type="number" value="${d.base||0}" oninput="savePayroll()"></td>
    <td><input type="number" value="${d.ded||0}" oninput="savePayroll()"></td>
    <td class="net"></td>
    <td><button onclick="this.closest('tr').remove();savePayroll()" style="background:#ffe3e3; color:#e03131;">ì‚­ì œ</button></td>`;
  payrollBody.appendChild(tr);
}
function savePayroll(){
  let arr=[],sum=0;
  payrollBody.querySelectorAll("tr").forEach(tr=>{
    const i=tr.querySelectorAll("input"); const net=(+i[1].value||0)-(+i[2].value||0);
    tr.querySelector(".net").textContent=net.toLocaleString(); sum+=net;
    arr.push({type:tr.querySelector("select").value,name:i[0].value,base:+i[1].value||0,ded:+i[2].value||0});
  });
  localStorage.setItem("payroll_"+curP,JSON.stringify(arr));
  payrollFoot.innerHTML=`<tr><td colspan="4" style="text-align:right; font-weight:700;">ì›” í•©ê³„:</td><td style="font-weight:700; color:#4f6fdc;">${sum.toLocaleString()}</td><td></td></tr>`;
  updateSummary();
}
function loadPayroll(){ payrollBody.innerHTML=""; P(curP).forEach(addPayroll); savePayroll(); }

function addAgency(d={}){
  const tr=document.createElement("tr");
  tr.innerHTML=`<td><select onchange="saveAgency()"><option ${d.type==='êµ­ë¹„'?'selected':''}>êµ­ë¹„</option><option ${d.type==='ì‹œë¹„'?'selected':''}>ì‹œë¹„</option></select></td>
    <td><input value="${d.name||""}" oninput="saveAgency()"></td>
    <td><input type="number" value="${d.n||0}" oninput="saveAgency()"></td>
    <td><input type="number" value="${d.h||0}" oninput="saveAgency()"></td>
    <td><input type="number" value="${d.e||0}" oninput="saveAgency()"></td>
    <td><input type="number" value="${d.i||0}" oninput="saveAgency()"></td>
    <td class="sum"></td>
    <td><button onclick="this.closest('tr').remove();saveAgency()" style="background:#ffe3e3; color:#e03131;">ì‚­ì œ</button></td>`;
  agencyBody.appendChild(tr);
}
function saveAgency(){
  let arr=[],sum=0;
  agencyBody.querySelectorAll("tr").forEach(tr=>{
    const i=tr.querySelectorAll("input"); const s=(+i[1].value)+(+i[2].value)+(+i[3].value)+(+i[4].value);
    tr.querySelector(".sum").textContent=s.toLocaleString(); sum+=s;
    arr.push({type:tr.querySelector("select").value,name:i[0].value,n:+i[1].value,h:+i[2].value,e:+i[3].value,i:+i[4].value});
  });
  localStorage.setItem("agency_"+curA,JSON.stringify(arr));
  agencyFoot.innerHTML=`<tr><td colspan="6" style="text-align:right; font-weight:700;">ì›” í•©ê³„:</td><td style="font-weight:700; color:#d26900;">${sum.toLocaleString()}</td><td></td></tr>`;
  updateSummary();
}
function loadAgency(){ agencyBody.innerHTML=""; A(curA).forEach(addAgency); saveAgency(); }

/* [í˜„í™© ì—…ë°ì´íŠ¸ ë° ë Œë”ë§] */
function updateSummary(){
  let sp=0, sa=0;
  for(let m=1;m<=12;m++){
    sp += P(m).reduce((x,r)=>x+(r.base-r.ded),0);
    sa += A(m).reduce((x,r)=>x+r.n+r.h+r.e+r.i,0);
  }
  const sumP = document.getElementById("sumPayroll"), sumA = document.getElementById("sumAgency");
  if(sumP) sumP.textContent = `ì—°ê°„ ê¸‰ì—¬ í•©ê³„: ${sp.toLocaleString()}ì›`;
  if(sumA) sumA.textContent = `ì—°ê°„ ê¸°ê´€ë¶€ë‹´ê¸ˆ í•©ê³„: ${sa.toLocaleString()}ì›`;
}

function renderMonthStatusTabs(){
  const container = document.getElementById("statusMonthTabs"); container.innerHTML = "";
  for(let i=1; i<=12; i++){
    const b = document.createElement("button"); b.textContent = i + "ì›”";
    b.onclick = () => { [...container.children].forEach(x=>x.classList.remove("active")); b.classList.add("active"); showMonthDetail(i); };
    container.appendChild(b);
  }
}

function showMonthDetail(m){
  const detail = document.getElementById("monthDetail"), area = document.getElementById("monthDataArea"), title = document.getElementById("selectedMonthTitle");
  detail.style.display = "block"; title.textContent = m + "ì›” ì§€ì¶œ ë‚´ì—­";
  const p = P(m), a = A(m); const ps = p.reduce((x,r)=>x+(r.base-r.ded),0), as = a.reduce((x,r)=>x+r.n+r.h+r.e+r.i,0);
  area.innerHTML = `<div style="margin-bottom:15px; font-weight:bold;">ì›” ì´ì•¡: ${(ps+as).toLocaleString()}ì›</div>
    <strong>ê¸‰ì—¬ ë‚´ì—­ (${ps.toLocaleString()}ì›)</strong>
    <table><tr><th>êµ¬ë¶„</th><th>ì´ë¦„</th><th>ì‹¤ì§€ê¸‰ì•¡</th></tr>${p.map(r=>`<tr><td>${r.type}</td><td>${r.name}</td><td>${(r.base-r.ded).toLocaleString()}ì›</td></tr>`).join("") || "<tr><td colspan=3>ë‚´ì—­ ì—†ìŒ</td></tr>"}</table><br>
    <strong>ê¸°ê´€ë¶€ë‹´ê¸ˆ ë‚´ì—­ (${as.toLocaleString()}ì›)</strong>
    <table><tr><th>êµ¬ë¶„</th><th>ì´ë¦„</th><th>í•©ê³„</th></tr>${a.map(r=>`<tr><td>${r.type}</td><td>${r.name}</td><td>${(r.n+r.h+r.e+r.i).toLocaleString()}ì›</td></tr>`).join("") || "<tr><td colspan=3>ë‚´ì—­ ì—†ìŒ</td></tr>"}</table>`;
}

function renderPersonal(){
  const body = document.getElementById("personalBody"); body.innerHTML = "";
  let userMap = {};
  for(let m=1;m<=12;m++){
    P(m).forEach(r=>{
      if(!r.name) return; if(!userMap[r.name]) userMap[r.name]={kp:0, ka:0, sp:0, sa:0};
      if(r.type==='êµ­ë¹„') userMap[r.name].kp+=(r.base-r.ded); else userMap[r.name].sp+=(r.base-r.ded);
    });
    A(m).forEach(r=>{
      if(!r.name) return; if(!userMap[r.name]) userMap[r.name]={kp:0, ka:0, sp:0, sa:0};
      const s=(r.n+r.h+r.e+r.i); if(r.type==='êµ­ë¹„') userMap[r.name].ka+=s; else userMap[r.name].sa+=s;
    });
  }
  const names = Object.keys(userMap).sort();
  names.forEach(n=>{
    const d=userMap[n]; const total=d.kp+d.ka+d.sp+d.sa;
    const tr=document.createElement("tr");
    tr.innerHTML=`<td style="font-weight:bold">${n}</td><td class="bg-kuk">${d.kp.toLocaleString()}</td><td class="bg-kuk">${d.ka.toLocaleString()}</td><td class="bg-si">${d.sp.toLocaleString()}</td><td class="bg-si">${d.sa.toLocaleString()}</td><td class="total-cell">${total.toLocaleString()}</td>`;
    body.appendChild(tr);
  });
}

/* [ì´ˆê¸° ë¡œë“œ] */
monthTabs("payrollTabs",m=>{curP=m;loadPayroll();});
monthTabs("agencyTabs",m=>{curA=m;loadAgency();});
updateSummary();
</script>
</body>
</html>